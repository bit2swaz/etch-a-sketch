<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Etch-A-Sketch!</title>
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <h1>Etch-A-Sketch</h1>

    <button id="newGridBtn">Change Grid Size</button>

    <div id="grid-container"></div>

    <script>
        const gridContainer = document.getElementById('grid-container');

        function getRandomRGBColor() {
            const r = Math.floor(Math.random() * 256);
            const g = Math.floor(Math.random() * 256);
            const b = Math.floor(Math.random() * 256);
            return `rgb(${r}, ${g}, ${b})`;
        }

        function createGrid(size) {
            gridContainer.innerHTML = "";
            
            const totalSquares = size * size;
            const squareSize = 960/size;

            for (let i = 0; i < totalSquares; i++) {
                const square = document.createElement("div");
                square.classList.add("grid-square");

                square.style.height = `${squareSize}px`;
                square.style.width = `${squareSize}px`;

                square.setAttribute("data-hits", 0);
                square.setAttribute("data-color", "");

                square.addEventListener("mouseover", function() {
                    let hits = parseInt(this.dataset.hits);

                    if (hits === 0) {
                        const randomColor = getRandomRGBColor();
                        this.style.backgroundColor = randomColor;
                        this.dataset.color = randomColor;
                        this.style.opacity = "0.1";
                        this.dataset.hits = 1;
                    } else {
                        if (hits < 10) {
                            hits++;
                            this.style.opacity = `${hits * 0.1}`;
                            this.dataset.hits = hits;
                        }
                    }
                });

                gridContainer.appendChild(square);
            }
        }

        const newGridButton = document.getElementById("newGridBtn");

        newGridButton.addEventListener("click", function() {
            let input;
            let newSize;

            while (true) {
                input = prompt("Enter number of squares per size (max 100): ");

                if (input === null) {
                    break;
                }

                newSize = parseInt(input);

                if (isNaN(newSize) || newSize < 1 || newSize > 100) {
                    alert("Please enter a valid number between 1 and 100.");
                } else {
                    createGrid(newSize);
                    break;
                }
            }
        });

        createGrid(16);
    </script>
</body>
</html>